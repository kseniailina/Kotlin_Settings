package patches.vcsRoots

import jetbrains.buildServer.configs.kotlin.v2018_2.*
import jetbrains.buildServer.configs.kotlin.v2018_2.ui.*
import jetbrains.buildServer.configs.kotlin.v2018_2.vcs.GitVcsRoot

/*
This patch script was generated by TeamCity on settings change in UI.
To apply the patch, change the vcsRoot with id = 'HttpAdminTcqaBitbucketServer7990scmKsepKseproject1git'
accordingly, and delete the patch script.
*/
changeVcsRoot(RelativeId("HttpAdminTcqaBitbucketServer7990scmKsepKseproject1git")) {
    val expected = GitVcsRoot({
        id("HttpAdminTcqaBitbucketServer7990scmKsepKseproject1git")
        name = "http://admin@tcqa-bitbucket-server:7990/scm/ksep/kseproject1.git"
        url = "http://admin@tcqa-bitbucket-server:7990/scm/ksep/kseproject1.git"
        branchSpec = """
            +:refs/heads/(*)
            -:refs/heads/release/4.0
        """.trimIndent()
        serverSideAutoCRLF = true
        authMethod = password {
            userName = "%system.bitbuck.username%"
            password = "%system.bitbuck.password%"
        }
    })

    check(this == expected) {
        "Unexpected VCS root settings"
    }

    (this as GitVcsRoot).apply {
        authMethod = password {
            userName = "%system.bitbuck.username%"
            password = "credentialsJSON:b86078be-13a7-464d-9abf-b958d60fbe0f"
        }
    }

}
